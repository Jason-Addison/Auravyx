IF(NOT CMAKE_ASM_COMPILE_OBJECT)
  IF(UNIX)
    # Assume x86 if no detection is done
    SET(CMAKE_ASM_COMPILER_ARG1 "-f elf")

    IF(CMAKE_UNAME)
#FIXME: Check for defined CMAKE_SYSTEM_MACHINE
#FIXME: cross-compilation?
#EXEC_PROGRAM(uname ARGS -m OUTPUT_VARIABLE CMAKE_SYSTEM_MACHINE)
      IF(CMAKE_SYSTEM_MACHINE MATCHES "x86_64")
        SET(CMAKE_ASM_COMPILER_ARG1 "-f elf64")
      ENDIF(CMAKE_SYSTEM_MACHINE MATCHES "x86_64")
    ENDIF(CMAKE_UNAME)
  ENDIF(UNIX)

  IF(APPLE)
    SET(CMAKE_ASM_COMPILER_ARG1 "-f macho")
  ENDIF(APPLE)

  IF(WIN32)
    SET(CMAKE_ASM_COMPILER_ARG1 "-f win32 -DWIN32")
  ENDIF(WIN32)

  SET(CMAKE_ASM_COMPILE_OBJECT "<CMAKE_ASM_COMPILER> <FLAGS> -o <OBJECT> <SOURCE>")
ENDIF(NOT CMAKE_ASM_COMPILE_OBJECT)

IF(NOT CMAKE_ASM_LINK_EXECUTABLE)
  SET(CMAKE_ASM_LINK_EXECUTABLE "")
ENDIF(NOT CMAKE_ASM_LINK_EXECUTABLE)

# work-aorund broken CMake versions
SET(CMAKE_INCLUDE_FLAG_ASM "-I")

SET(CMAKE_ASM_INFOMATION_LOADED 1)
